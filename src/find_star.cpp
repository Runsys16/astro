#ifndef FIND_STAR_CPP
#define FIND_STAR_CPP
//--------------------------------------------------------------------------------------------------------------------
#define OFFSET(__x, __y)		((int__x+(int)__y*pRB->w)
//--------------------------------------------------------------------------------------------------------------------
#include "find_star.h"
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
FindStar::FindStar()
{
	log( (char*)"FindStar::FindStar()" );
}
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
FindStar::~FindStar()
{
	log( (char*)"FindStar::~FindStar()" );
	
	pRB			= NULL;
	pView		= NULL;
	pConvert	= NULL;
}
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
int FindStar::getOffset( int X, int Y )
{
    int d = pRB->d;

    return d*(X) + d*(Y)* pRB->w;
}
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
float FindStar::getLum(int offset )
{
    float r;
    float g;
    float b;

    
    try
    {
        
        r = ptr[offset+0]; 
        g = ptr[offset+1]; 
        b = ptr[offset+2]; 

    }
    catch ( const std::exception& e )
    {
        std::cout << e.what() << std::endl;
        return -1;
    }

    float l = LUM(r,g,b);

    return l;
}
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
float FindStar::getLum( vec2 v )
{
    int offset = getOffset( v.x, v.y );
    return getLum( offset );
}
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
void FindStar::find_line( vec2 v)
{
	logf( (char*)"FindStar::find_line( " VEC2_PRINTF " )", VEC2_AFF(v) );
	
	if ( pRB == NULL )		{ log( (char*)"[ Erreur ] pRG = NULL" ); return; }

	logf( (char*)"Lum = %0.4f", getLum(v) );
}
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------
#endif
//--------------------------------------------------------------------------------------------------------------------
//
//--------------------------------------------------------------------------------------------------------------------


